<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

		<link href="https://fonts.googleapis.com/css?family=Baloo+Chettan|Fira+Sans" rel="stylesheet">
		<script src="https://use.fontawesome.com/cba1a2fa20.js"></script>


		<script>
// ************** from code pen demo of JSON_P ******************************
function apiCall(apiURL) {
/* --------------------------------------------------------
This codepen shows 3 different ways to use JSONP to work around cross-origin errors.
The examples below call the Dark Sky Weather API.

** What is JSONP? **
Browser security usually prohibits you from accessing data on another pageunless it has the same origin (domain name / web address). A common error we get when attempting to access data on a different origin is:

"XMLHttpRequest cannot load http://external-domain/service.
No ‘Access-Control-Allow-Origin’ header is present on the requested resource.
Origin ‘http://my-domain’ is therefore not allowed access."

So, JSONP is one way to work around this restriction.

To read more about it:
https://www.sitepoint.com/jsonp-examples/
http://learn.jquery.com/ajax/working-with-jsonp/
https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS

To use it in your application, check out the code below!

TL;DR
- $.getJSON: add ?callback=? (or &callback=?) to your URL
- $.ajax: use dataType: 'jsonp'
- no jQuery: append a script to the page with  its src=<<apiURL?callback=callbackFunction>>

*/

// Comment/Uncomment the functions below. They all give the same results.
// See each section below for the code used.

getJSON_JSONP(); // $.getJSON example
//ajax_JSONP();     // $.ajax example
//pure_JS_JSONP(); // pure JavaScript (no jQuery)

/*
	------------------------------------------------
	$.getJSON example

	With $.getJSON, we request JSONP by simply adding `callback=?` to the
	end of the URL for our API request. The displayJSON() function is called when complete.
	Remember that a query string at the end of the url starts with a ? with additional parameters
	separated by ampersand & https://url?param1&param2

	http://api.jquery.com/jquery.getjson/
	------------------------------------------------
*/

function getJSON_JSONP() {
$.getJSON(apiURL + "&callback=?").done(displayJSON);

// show which method we used
$("#method-used").text("$.getJSON");
}

/*
	------------------------------------------------
	$.ajax example

	This function uses $.ajax - a JSONP request is made by adding dataType: 'jsonp'
	Once the request is complete, the displayJSON function is called to show the results.

	http://api.jquery.com/jquery.ajax/
	------------------------------------------------
*/

function ajax_JSONP() {
$.ajax({
	url: apiURL,
	dataType: "jsonp"
}).done(displayJSON);

// show which method we used
$("#method-used").text("$.ajax");
}

/*
	------------------------------------------------
	Pure JavaScript JSONP Example (no jQuery)

	This function does not use jQuery and it works by appending a script element
	to the page with the API URL and a callback function as the src.
	The API is called - when a response comes back, the callback function is called.
	------------------------------------------------
*/

function pure_JS_JSONP() {
// create a script element to append to our page
var scriptEl = document.createElement("script");

// use the API URL as the src of our script element and append ?callback=<<function name>>
// to the end to specify what function to call when the request is complete
scriptEl.src = apiURL + "&callback=displayJSON";

// append the script to the last line of the <body> element
document.body.appendChild(scriptEl);

// show which method we used
document.getElementById("method-used").textContent = "JavaScript (No jQuery)";
}
}

// This is the function we call in all the JSONP examples above to show the results of the API call
function displayJSON(data) {
document.getElementById("json-data").innerHTML = JSON.stringify(data.currently, null, 2);
}

// Basic setup. You can ignore this line of code.
// It gets the location and builds the API URL required for the JSONP Examples above.
getCoords().then(coords => apiCall("https://api.darksky.net/forecast/a70fe9d9a60d04a1e71dd077980ac76a/" +
						 coords + "/?units=auto&exclude=minutely,hourly,daily"));
////************************* end demo **********************

		function getF(c) { return c * 9 / 5 + 32; }
		function getC(f) { return (f - 32) * 5 / 9; }
		var lat = 0.0;
		var long = 0.0;

		var writeWeather = function(json){

			$("#message").html("json: " + JSON.stringify(json));
			$("#temperature").html(Math.round(getF(json.main.temp)));

			$("#descr").html(json.weather[0].description);
			$('#wIcon').attr("src",json.weather[0].icon);

			$("#hum").html(json.main.humidity + "%");
			$("#wind").html(json.wind.speed);

			// $("#sunR").html(json.sys.sunrise );
			// $("#sunS").html(json.sys.sunrise);

			//$("#wIcon").css("background-image", "url('" + json.weather[0].icon + "')");

			$("body").css("background-image", "url('https://www.inetteacher.com/webdev/port/img_7539-01-16x9.jpg')");

			var mapView = 'https://maps.googleapis.com/maps/api/staticmap?center=' + lat + "," + long + '&size=1000x500&zoom=7&key=AIzaSyDQ-Ak_FPICE_Xjp4AHEXkEwgxSmVhUdMo'
			$("#mainPanel").css("background-image", "url('" + mapView + "')");

		}

		var getCoords = function(){

			if (!navigator.geolocation){
				$("#message").html("<p>Geolocation is not supported by your browser</p>");
				return;
			} else {
					navigator.geolocation.getCurrentPosition(function(position) {
						lat = position.coords.latitude;
						long = position.coords.longitude;
						$("#coords").html("coords: " + lat + " : " + long );
					getWeather(lat, long);
					});
				}
		}

		var getWeather = function(long, lat){

    	$.ajax({
            type: "GET",
            //url: "https://fcc-weather-api.glitch.me//api/current?lon=" + long + "&lat=" + lat,
						url: "https://api.darksky.net/forecast/4b31a2eff50d4e11e5c6441a48195d61/" + long + "," + lat,


            data: {},
            dataType: 'json',
            success: function(data){
							writeWeather(data)
						},
            error: function(err) { alert("Internet Error!"); },
            beforeSend: function(xhr) {
            }
    	});

		}

		// start jquery...  .... ..... ..... ..... ...
		$(document).ready(function(){

			var localTime = new Date().toLocaleTimeString();
			var localDate = new Date().toLocaleDateString();

			$("#wtime").html(localTime);
			$("#wdate").html(localDate);


			$('#wIcon').attr("src","https://cdn.glitch.com/6e8889e5-7a72-48f0-a061-863548450de5%2F03d.png?1499366020890");

			getCoords();


			$("#scaleF").click(function(){
				//switch temp scale, leave button showing clicked
			});
			$("#scaleC").click(function(){
				//switch temp scale
			});

		});

		</script>

		<style  type="text/css" >
		body{
		    background-color: #fc0062;
				background-repeat: no-repeat;
				background-attachment: fixed;
				background-position: center top;
				background-repeat: no-repeat;
				background-size: cover;
		}
		.main{
		  margin-top: 150px;
		}
		.app{
			border: 1px solid #000000;
			border-radius: 16px;
			box-shadow: 5px 5px 8px #010001;
			background-repeat: no-repeat;
			background-attachment: fixed;
			background-position: center;
			background-repeat: no-repeat;
			background-size: cover;
		}
		.ph{
			 border:1px solid #000000;
			 background-color: #000000;
			 border-radius: 15px 15px 0px 0px;
		}
		.h {
			color:#ffffff;
			font-family: 'Baloo Chettan', sans-serif;
			font-size:30px;
		}
		.d {
			color:#f2ff5c;
			margin-top: 8px;
			padding:3px;
			font-size:16px;
			font-family: 'Fira Sans', sans-serif;
			font-weight: 300;

		}
		.t {
			color:#ffffff;
			margin-top: 8px;
			padding:3px;
			font-size:16px;
			font-family: 'Fira Sans', sans-serif;
			font-weight: 300;
		}

		.body1{ margin-top: 20px;
			color:#ffffff;
			font-family: 'Baloo Chettan', sans-serif;
			font-size:154px;
			text-shadow: 6px 6px #000000; height: 140px;
			line-height: 132px;
		}
		#wIcon {
			border: 3px solid #ffffff;
			border-radius: 50%;
			background-color: #05f0a9;
			width:60px; vertical-align: top;
		}

		.c{
			border: 1px solid #777777;
			color: #777777;
			padding:2px;
			font-size:15px;
			background-color: transparent;
			font-family: 'Fira Sans', sans-serif;
			font-weight: 300;
		}
		.f{
			border: 1px solid #05f0a9;
			color: #05f0a9;
			padding:2px;
			background-color: transparent;
			font-size:15px;
			font-family: 'Fira Sans', sans-serif;
			font-weight: 300;
		}

		#wrapper {
		  display: flex;
		}
		#left {
		  flex: 0 0 50%;
		}
		#right {
		  flex: 1;
		}

		</style>
	</head>
	<body>

<div id="message"></div>
<div id="coords"></div>


<div class="container-fluid center-block main">

	<div class="row ">
		<div class="col-sm-3" style="padding:100px">&nbsp; </div>


		<div class="col-sm-6 text-center" >


			<div id="mainPanel" class="panel  app" >


			  <div class="panel-heading ph" >

					<div class="container-fluid ">
						<div class="row ">
							<div class="col-sm-6 h" >
								Local Weather <i id="thermometer" class="fa fa-thermometer-three-quarters" aria-hidden="true"></i>
							</div>

							<div id="wdate" class="col-sm-3 d text-center" >Today
							</div>
							<div id="wtime" class="col-sm-3 t text-center" >Now
							</div>
						</div>
					</div>

				</div>


				<div class="panel-body text-left">
							<div class="body1">
								<span  id="temperature"></span><img id="wIcon"  />
							</div>


							<!-- end body row.... -->


							<div class="container-fluid ">

						<div class="row " >
							<div class="col-sm-5 " style="background-color:#000000; border-radius:15px; padding:12px;" >

								<span class="t" id="descr">descr...</span>

<!-- missing values here, maybe add later... -->
								<div id="wrapper">
  								<div id="left" class="d">
										Humidity:<br/>
										Wind:<br/>
										Sun Rise:<br/>
										Sun Set:<br/>
										Scale:<br/>

									</div>
  								<div id="right" class="t">
										<span id="hum">n/a</span><br/>
										<span id="wind">n/a</span><br/>
										<span id="sunR">n/a</span><br/>
										<span id="sunS">n/a</span><br/>
										<button id="c" class="btn c">&nbsp;C&nbsp;</button> <button id="c" class="btn f">&nbsp;F&nbsp;</button>
									</div>
								</div>

							</div>
							<div class="col-sm-7" >
								&nbsp;
							</div>
							<!-- end body row.... -->
						</div>


						<!-- end body container.... -->
						</div>
					<!-- end body panel.... -->
				</div>

					<!-- end app panel.... -->
			</div>

		<!-- end main center cell .... -->
		</div>

		<!-- end main 3rd cell .... -->
		<div class="col-sm-3">&nbsp; </div>

				<!-- end main row .... -->
	</div>

	<!-- end main container .... -->
</div>

	</body>
</html>

<!--
cd gitdir/freecodecamp/weather browser-sync start --server --port 3001 --files="./*"
-- >
